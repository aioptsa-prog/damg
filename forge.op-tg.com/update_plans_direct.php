<?php
/**
 * ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
 */

require_once __DIR__ . '/config/db.php';

echo "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ø§Ù‚Ø§Øª...\n\n";

try {
    $pdo = db();

    // Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    $pdo->exec("DELETE FROM subscription_plans");
    echo "âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©\n";

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    $plans = [
        [1, 'Ù…Ø¬Ø§Ù†ÙŠ', 'free', 'Ù„Ù„ØªØ¬Ø±Ø¨Ø© ÙˆØ§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù', 0, 0, 'SAR', 10, 0, 0, 0, 0, 0, '["10 ÙƒØ´Ù Ø£Ø±Ù‚Ø§Ù… Ù‡Ø§ØªÙ", "Ø­Ù…Ù„Ø© Ø¨Ø­Ø« ÙˆØ§Ø­Ø¯Ø©", "ØªØµØ¯ÙŠØ± ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯", "Ø¨Ø¯ÙˆÙ† ÙˆØ§ØªØ³Ø§Ø¨"]', 1, 0],
        [2, 'Ø£Ø³Ø§Ø³ÙŠ', 'basic', 'Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø£ÙØ±Ø§Ø¯ ÙˆØ§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ØµØºÙŠØ±Ø©', 149, 1490, 'SAR', 100, 0, 0, 0, 0, 0, '["100 ÙƒØ´Ù Ø£Ø±Ù‚Ø§Ù… Ù‡Ø§ØªÙ Ø´Ù‡Ø±ÙŠØ§Ù‹", "10 Ø­Ù…Ù„Ø§Øª Ø¨Ø­Ø«", "100 Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø´Ù‡Ø±ÙŠØ§Ù‹", "ØªØµØ¯ÙŠØ± ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯", "Ø¯Ø¹Ù… Ø£ÙˆÙ„ÙˆÙŠØ©"]', 1, 1],
        [3, 'Ø§Ø­ØªØ±Ø§ÙÙŠ', 'professional', 'Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…ØªÙˆØ³Ø·Ø© ÙˆØ§Ù„ÙØ±Ù‚', 349, 3490, 'SAR', 500, 0, 0, 0, 0, 0, '["500 ÙƒØ´Ù Ø£Ø±Ù‚Ø§Ù… Ù‡Ø§ØªÙ Ø´Ù‡Ø±ÙŠØ§Ù‹", "50 Ø­Ù…Ù„Ø© Ø¨Ø­Ø«", "500 Ø±Ø³Ø§Ù„Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ø´Ù‡Ø±ÙŠØ§Ù‹", "ØªØµØ¯ÙŠØ± ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯", "Ø¯Ø¹Ù… Ù…ØªÙ‚Ø¯Ù…", "Ø£ÙˆÙ„ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø¯Ø¹Ù…"]', 1, 2],
        [4, 'Ù…Ø¤Ø³Ø³Ø§Øª', 'enterprise', 'Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø®Ø§ØµØ©', 699, 6990, 'SAR', 0, 0, 0, 0, 0, 0, '["ÙƒØ´Ù Ø£Ø±Ù‚Ø§Ù… Ù‡Ø§ØªÙ ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯", "Ø­Ù…Ù„Ø§Øª Ø¨Ø­Ø« ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©", "Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©", "ØªØµØ¯ÙŠØ± ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯", "Ù…Ø¯ÙŠØ± Ø­Ø³Ø§Ø¨ Ù…Ø®ØµØµ", "Ø¯Ø¹Ù… Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©", "API Ù…Ø®ØµØµ"]', 1, 3],
    ];

    $stmt = $pdo->prepare("INSERT INTO subscription_plans (id, name, slug, description, price_monthly, price_yearly, currency, credits_phone, credits_email, credits_export, max_saved_searches, max_saved_lists, max_list_items, features, is_active, sort_order) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

    foreach ($plans as $plan) {
        $stmt->execute($plan);
        echo "âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø©: {$plan[1]}\n";
    }

    echo "\n=== Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ===\n";
    $result = $pdo->query("SELECT * FROM subscription_plans ORDER BY sort_order");
    foreach ($result as $p) {
        echo "\nğŸ“¦ {$p['name']} - {$p['price_monthly']} Ø±.Ø³/Ø´Ù‡Ø±\n";
        echo "   ÙƒØ´Ù Ù‡Ø§ØªÙ: " . ($p['credits_phone'] == 0 ? 'ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯' : $p['credits_phone']) . "\n";
        $features = json_decode($p['features'], true);
        if ($features) {
            foreach ($features as $f)
                echo "   â€¢ {$f}\n";
        }
    }

    echo "\nâœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!\n";

} catch (Exception $e) {
    echo "âŒ Ø®Ø·Ø£: " . $e->getMessage() . "\n";
}
